<div class="module-header">
  <h2><i class="fas fa-cloud-sun"></i> Paris weather</h2>
  <p>Today and next five days · Data from Open-Meteo · Central Paris</p>
</div>

<style>
  #paris-weather-days {
    display: flex;
    flex-wrap: wrap;
    gap: 14px;
    margin-top: 15px;
  }

  .weather-day {
    flex: 1 1 140px;
    background: #fff;
    border-radius: 14px;
    padding: 14px;
    text-align: center;
    box-shadow: 0 2px 8px rgba(0,0,0,0.08);
  }

  .weather-day a {
    text-decoration: none;
    color: #222;
  }

  .weather-day img {
    width: 48px;
    height: 48px;
    margin-bottom: 8px;
  }
</style>

<div id="paris-weather-days">Loading…</div>

<script>
async function loadParisWeather() {
  const url =
    "https://api.open-meteo.com/v1/forecast?latitude=48.8566&longitude=2.3522&daily=weathercode,temperature_2m_max,temperature_2m_min&timezone=Europe%2FParis";

  let data;

  try {
    const r = await fetch(url, { cache: "no-store" });
    data = await r.json();
  } catch (e) {
    const proxy =
      "https://cors-proxy.api.exponential-hub.workers.dev/?" + url;
    const r = await fetch(proxy);
    data = await r.json();
  }

  const wrap = document.getElementById("paris-weather-days");
  wrap.innerHTML = "";

  const days = data.daily.time;
  const icons = data.daily.weathercode;
  const tmax = data.daily.temperature_2m_max;
  const tmin = data.daily.temperature_2m_min;

  // WORKING ICON SOURCE
  const iconURL = code =>
    `https://www.dwd.de/DWD/wetter/wv_allg/svg/${code}.svg`;

  days.slice(0, 7).forEach((day, i) => {
    const pretty = new Date(day).toLocaleDateString("en-US", {
      weekday: "short",
      month: "short",
      day: "numeric"
    });

    const link =
      `https://weather.com/weather/tenday/l/Paris+France?day=${i}`;

    const div = document.createElement("div");
    div.className = "weather-day";

    div.innerHTML = `
      <a href="${link}" target="_blank">
        <img src="${iconURL(icons[i])}" />
        <div style="font-weight:600;">${pretty}</div>
        <div>${Math.round(tmax[i])}° / ${Math.round(tmin[i])}°C</div>
      </a>
    `;

    wrap.appendChild(div);
  });
}

loadParisWeather();
</script>
