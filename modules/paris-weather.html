<!-- PARIS WEATHER MODULE â€” FINAL CLEAN VERSION -->

<div class="module-header">
  <h2><i class="fas fa-cloud-sun-rain"></i> Paris Weather</h2>
  <p class="panel-subtitle">
    Today + next 5 days Â· Data: Open-Meteo Â· Tap for full forecast
  </p>
</div>

<div id="paris-weather-days" class="weather-grid">
  <p>Loadingâ€¦</p>
</div>

<style>
  .weather-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 10px;
    margin-top: 10px;
  }

  .weather-day {
    background: rgba(255,255,255,0.85);
    border-radius: 12px;
    padding: 8px 0;
    text-align: center;
    font-size: 14px;
    line-height: 1.2;
    box-shadow: 0 2px 6px rgba(0,0,0,0.08);
  }

  .weather-day a {
    text-decoration: none;
    color: #222;
    display: block;
    padding: 4px;
  }

  .weather-emoji {
    font-size: 26px;
    margin-bottom: 2px;
  }

  .weather-date {
    font-weight: 600;
    margin-bottom: 2px;
  }

  .weather-temps {
    font-size: 13px;
    opacity: 0.85;
  }
</style>

<script>
  function parisWeatherIcon(code) {
    if (code === 0) return "â˜€ï¸";
    if (code === 1) return "ğŸŒ¤ï¸";
    if (code === 2) return "â›…";
    if (code === 3) return "â˜ï¸";
    if (code === 45 || code === 48) return "ğŸŒ«ï¸";
    if ([51, 53, 55].includes(code)) return "ğŸŒ¦ï¸";
    if ([61, 63, 65, 80, 81, 82].includes(code)) return "ğŸŒ§ï¸";
    if ([71, 73, 75, 85, 86].includes(code)) return "â„ï¸";
    if ([95, 96, 99].includes(code)) return "â›ˆï¸";
    return "ğŸŒ¡ï¸";
  }

  async function loadParisWeather() {
    const url =
      "https://api.open-meteo.com/v1/forecast" +
      "?latitude=48.8566&longitude=2.3522" +
      "&daily=weathercode,temperature_2m_max,temperature_2m_min" +
      "&timezone=Europe%2FParis";

    let data;

    try {
      const res = await fetch(url, { cache: "no-store" });
      data = await res.json();
    } catch (e) {
      const proxy =
        "https://cors-proxy.api.exponential-hub.workers.dev/?" + url;
      const res = await fetch(proxy);
      data = await res.json();
    }

    const container = document.getElementById("paris-weather-days");
    container.innerHTML = "";

    const days = data.daily.time;
    const codes = data.daily.weathercode;
    const tmax = data.daily.temperature_2m_max;
    const tmin = data.daily.temperature_2m_min;

    for (let i = 0; i < 6; i++) {
      const d = new Date(days[i]);
      const pretty = d.toLocaleDateString("en-US", {
        weekday: "short",
        month: "short",
        day: "numeric"
      });

      const icon = parisWeatherIcon(codes[i]);
      const hi = Math.round(tmax[i]);
      const lo = Math.round(tmin[i]);

      const link =
        "https://www.meteofrance.com/previsions-meteo-france/paris-75000?day=" +
        d.toISOString().slice(0, 10);

      const card = document.createElement("div");
      card.className = "weather-day";
      card.innerHTML = `
        <a href="${link}" target="_blank">
          <div class="weather-emoji">${icon}</div>
          <div class="weather-date">${pretty}</div>
          <div class="weather-temps">${hi}Â° / ${lo}Â°C</div>
        </a>
      `;
      container.appendChild(card);
    }
  }

  loadParisWeather();
</script>
